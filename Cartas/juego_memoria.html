<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego de Memoria</title>
<style>
  * { box-sizing: border-box; }
  html, body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', sans-serif;
    background: #ecf0f1;
    color: #2c3e50;
    height: 100%;
    width: 100%;
  }
  body {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #juego-container {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: 5px;
  }

  h1 { margin: 0; font-size: 2rem; }

  #form-jugador { margin: 5px 0; display: flex; flex-direction: column; align-items: center; }
  #form-jugador input {
    padding: 10px;
    font-size: 1.2rem;
    width: 60%;
    max-width: 250px;
    margin-bottom: 10px;
  }
  #form-jugador button {
    padding: 10px 20px;
    font-size: 1.2rem;
    background: #2980b9;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  #info { margin: 10px 0; font-size: 1.2rem; }

  #tablero {
    display: grid;
    justify-content: center;
    align-content: center;
    flex-grow: 1;
    gap: 5px;
    width: 100%;
    height: auto;
    max-height: 80%;
  }

  .carta {
    background: #2c3e50;
    color: white;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    cursor: pointer;
    user-select: none;
  }
  .carta img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 10px;
  }
  .oculta { background: #2c3e50; }
  .encontrada { visibility: hidden; }

  #pantallaFinal {
    position: fixed;
    top:0; left:0;
    width:100%;
    height:100%;
    background: #27ae60;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    text-align:center;
    padding:10px;
    font-size: 2rem;
  }
  #pantallaFinal h2 { font-size:3rem; margin-bottom: 20px; }
  #pantallaFinal p { font-size:2.5rem; margin-bottom: 20px; }
  #pantallaFinal button {
    font-size: 2rem;
    padding: 12px 24px;
    background: #2c3e50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

</style>
</head>
<body>

<div id="juego-container">
  <h1>Juego de Memoria</h1>
  <div id="form-jugador">
    <input type="text" id="nombreJugador" placeholder="Tu nombre..." />
    <button onclick="iniciarJuego()">Comenzar Juego</button>
  </div>
  <div id="info" style="display:none;">
    <strong>Jugador:</strong> <span id="jugadorActual"></span> |
    <strong>Tiempo:</strong> <span id="cronometro">00:00</span>
  </div>
  <div id="tablero"></div>
</div>

<div id="pantallaFinal" style="display:none;">
  <h2 id="resultadoJugador"></h2>
  <p id="resultadoTiempo"></p>
  <button onclick="reiniciarJuego()">Volver a jugar</button>
</div>

<script>
const tablero = document.getElementById('tablero');
const nombreInput = document.getElementById('nombreJugador');
const jugadorActual = document.getElementById('jugadorActual');
const cronometroSpan = document.getElementById('cronometro');
const info = document.getElementById('info');
const pantallaFinal = document.getElementById('pantallaFinal');
const resultadoJugador = document.getElementById('resultadoJugador');
const resultadoTiempo = document.getElementById('resultadoTiempo');

let cartas = [], seleccionadas = [], bloqueado = false;
let cronometroInterval, segundos = 0, jugador = '';
const totalCartas = 20;

function generarPares() {
  const pares=[];
  for(let i=1;i<=10;i++){
    pares.push({id:i,img:`imagenes/img${i}.jpg`});
    pares.push({id:i,img:`imagenes/img${i+10}.jpg`});
  }
  return pares;
}

function mezclar(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
}

function ajustarTablero(){
  let columnas, filas;
  if(window.innerWidth > window.innerHeight){
    columnas=7; filas=3;
  } else {
    columnas=4; filas=5;
  }
  tablero.style.gridTemplateColumns=`repeat(${columnas},1fr)`;
  tablero.style.gridTemplateRows=`repeat(${filas},1fr)`;

  // Ajustar tamaño de cartas
  const anchoCarta = Math.floor((tablero.clientWidth - (columnas-1)*5)/columnas);
  const altoCarta = Math.floor((tablero.clientHeight - (filas-1)*5)/filas);
  const size = Math.min(anchoCarta, altoCarta);
  document.querySelectorAll('.carta').forEach(c=>{c.style.width=size+'px'; c.style.height=size+'px'; c.style.fontSize=(size/5)+'px';});
}

function iniciarJuego(){
  const nombre = nombreInput.value.trim();
  if(nombre===''){alert('Por favor ingresa tu nombre'); return;}
  jugador=nombre;
  jugadorActual.textContent=jugador;
  nombreInput.value='';
  document.getElementById('form-jugador').style.display='none';
  info.style.display='block';
  segundos=0;
  actualizarCronometro();
  cronometroInterval=setInterval(()=>{segundos++; actualizarCronometro();},1000);
  crearTablero();
}

function actualizarCronometro(){
  let min=String(Math.floor(segundos/60)).padStart(2,'0');
  let seg=String(segundos%60).padStart(2,'0');
  cronometroSpan.textContent=`${min}:${seg}`;
}

function crearTablero(){
  tablero.innerHTML=''; cartas=[]; seleccionadas=[]; bloqueado=false;
  const copiaPares=generarPares(); mezclar(copiaPares);
  copiaPares.forEach((obj,index)=>{
    const carta=document.createElement('div');
    carta.classList.add('carta','oculta');
    carta.dataset.index=index;
    carta.dataset.id=obj.id;
    carta.dataset.imagen=obj.img;
    carta.textContent=index+1;
    carta.addEventListener('click',()=>{
      if(bloqueado || carta.classList.contains('encontrada') || !carta.classList.contains('oculta')) return;
      mostrarCarta(carta);
      seleccionadas.push(carta);
      if(seleccionadas.length===2){ bloqueado=true; verificarPareja(); }
    });
    cartas.push(carta); tablero.appendChild(carta);
  });
  ajustarTablero();
}

function mostrarCarta(carta){
  carta.classList.remove('oculta');
  const img=document.createElement('img'); img.src=carta.dataset.imagen;
  carta.textContent=''; carta.appendChild(img);
}

function ocultarCarta(carta){ carta.innerHTML=parseInt(carta.dataset.index)+1; carta.classList.add('oculta'); }

function verificarPareja(){
  const [c1,c2]=seleccionadas;
  if(c1.dataset.id===c2.dataset.id){
    setTimeout(()=>{c1.classList.add('encontrada'); c2.classList.add('encontrada'); seleccionadas=[]; bloqueado=false; verificarFin();},500);
  } else {
    setTimeout(()=>{ocultarCarta(c1); ocultarCarta(c2); seleccionadas=[]; bloqueado=false;},1000);
  }
}

function verificarFin(){
  const encontradas=document.querySelectorAll('.carta.encontrada');
  if(encontradas.length===totalCartas){
    clearInterval(cronometroInterval);
    mostrarPantallaFinal();
  }
}

function mostrarPantallaFinal(){
  const tiempo=cronometroSpan.textContent;
  resultadoJugador.textContent=`¡Bien hecho, ${jugador}!`;
  resultadoTiempo.textContent=`Tiempo: ${tiempo}`;
  pantallaFinal.style.display='flex';
}

function reiniciarJuego(){
  pantallaFinal.style.display='none';
  document.getElementById('form-jugador').style.display='flex';
  info.style.display='none';
  tablero.innerHTML='';
}

window.addEventListener('resize',ajustarTablero);
</script>

</body>
</html>
